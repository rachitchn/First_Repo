This is part 2 of commit 2 in master.